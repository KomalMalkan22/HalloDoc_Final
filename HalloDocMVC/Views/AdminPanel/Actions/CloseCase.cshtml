@{
    Layout = "../Shared/AdminLayout/_Layout";
}

@model HalloDocMVC.DBEntity.ViewModels.AdminPanel.CloseCaseModel

<div class="d-flex justify-content-center">
    <div class="d-flex flex-column my-2 col-lg-8 col-md-10">
        <div class="d-flex justify-content-between px-2">
            <div>
                <strong class="fs-4">
                    Close Case
                </strong>
            </div>
            <div>
                <a asp-controller="Dashboard" asp-action="Index" class="btn border border-info shadow-none">
                    <strong class="text-info">
                        <i class="fa fa-chevron-left" aria-hidden="true"></i> Back
                    </strong>
                </a>
            </div>
        </div>
        <div class="shadow bg-white rounded m-2 p-3">
            <div class="row">
                <div class="col-sm-6 mb-2">
                    <small class="text-secondary">Patient Name</small><br/>
                    <strong class="text-info">@Model.FirstName @Model.LastName</strong>
                    <span><small>(@Model.ConfirmationNumber)</small></span>
                </div>
                <div class="col d-flex justify-content-end align-self-center">
                    <a class="btn border border-info text-info">
                        Create Invoice Through Quickbooks
                    </a>
                </div>
            </div>
            
            <div class="mt-3">
                <strong class="fs-5">
                    Documents
                </strong>
            </div>

            <!--Desktop View-->
            <div class="d-none d-sm-block table-responsive mt-3 mb-0">
                <table class="table">
                    <thead class="border-0">
                        <tr class="table-secondary">
                            <th scope="col" class="table-text-header px-3">File Name</th>
                            <th scope="col" class="table-text-header ">Upload Date</th>
                            <th scope="col" class="table-text-header ">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        @if (Model.documents.Count == 0)
                        {
                            <tr>
                                <td class="text-center" colspan="3">
                                    No Documents to show !!
                                </td>
                            </tr>
                        }
                        @foreach (var item in Model.documents)
                        {
                            <tr>
                                <td class="table-text  px-3 filename"> <span> @item.FileName </span></td>
                                <td class="table-text  px-3">@item.CreatedDate.ToString("MMM d, yyyy")</td>
                                <td class="table-text text-center ">
                                    <a class="btn btn-sm btn-outline-info document-button" download href="@item.FileName.Replace("~","")">
                                        <i class="fa fa-cloud-download"></i>
                                    </a>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
            <!--End Desktop View-->
            <!--Mobile screen View-->
            <div class="d-block d-sm-none border-top my-2">
                @foreach (var item in Model.documents)
                {
                    <div class="border-bottom">
                        <div class="d-inline-flex my-2">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" value="" id="flexCheckDefault">
                                <input class="form-check-input RequestwisefilesId" type="hidden" value="@item.RequestwiseFilesId">
                            </div>
                            <div>
                                <small>@item.FileName</small>
                            </div>
                        </div>
                        <div class="d-flex flex-column">
                            <label class="text-break"><small>@item.Uploader</small></label>
                            <label><small>@item.CreatedDate.ToString("MMM d, yyyy")</small></label>
                        </div>
                        <div class="mb-3">
                            <a class="btn btn-sm border border-info text-info document-button me-2" download href="@item.FileName.Replace("~","")">
                                <i class="fa fa-cloud-download"></i>
                            </a>
                            <a class="btn btn-sm border border-info text-info document-button" asp-controller="Actions" asp-action="DeleteFile" asp-route-id="@item.RequestwiseFilesId" asp-route-Requestid="@Model.RequestId">
                                <i class="fa-solid fa-trash-can"></i>
                            </a>
                        </div>
                    </div>
                }
            </div>
            <!--End Mobile screen View-->

            <div class="mt-3">
                <strong class="fs-5">
                    Patient Information
                </strong>
            </div>

            <form method="post" asp-controller="Actions" asp-action="EditCloseCase">
                <div class="row mt-2">
                    <div class="col-md-6 col-sm-12 col-xs-12">
                        <div class="form-floating mb-3">
                            <input asp-for="FirstName" type="text" class="form-control shadow-none input" id="FirstName" placeholder="Enter First Name" autocomplete="off">
                            <label for="FirstName">First Name</label>
                        </div>
                    </div>
                    <div class="col-md-6 col-sm-12 col-xs-12">
                        <div class="form-floating mb-3">
                            <input asp-for="LastName" type="text" class="form-control shadow-none input" id="LastName" placeholder="Enter Last Name" autocomplete="off">
                            <label for="LastName">Last Name</label>
                        </div>
                    </div>
                    <div class="col-md-6 col-sm-12 col-xs-12">
                        <div class="form-floating mb-3">
                            <input asp-for="Client_DateOfBirth" type="date" class="form-control shadow-none input" id="DateOfBirth" placeholder="Enter Date of Birth" autocomplete="off">
                            <label for="DateOfBirth">Date of Birth</label>
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div class="mb-3 d-flex">
                            <div class="form-floating h-100 w-100">
                                <input asp-for="Client_PhoneNumber" type="tel" class="form-control shadow-none input" id="phone" autocomplete="off">
                                <label for="phone">Phone Number</label>
                            </div>
                            <button class="btn border border-info text-info mx-2 " style="height:3.5rem;width:4rem">
                                <i class="bi bi-telephone-fill"></i>
                            </button>
                        </div>
                    </div>

                    <div class="col-md-6 col-sm-12 col-xs-12">
                        <div class="form-floating mb-3">
                            <input asp-for="Client_Email" type="email" id="email" class="form-control shadow-none input" placeholder="name@example.com" autocomplete="off">
                            <label for="email">Email</label>
                        </div>
                    </div>
                    <div class="d-flex justify-content-end">
                        <span id="edit" onclick=" toggleFormElements('true')" class="btn btn-info text-white rounded me-2">Edit</span>
                        <input type="submit" value="Save" id="save" class="btn btn-info text-white rounded me-2">
                    </div>
                </div>
            </form>    
            <form asp-controller="Actions" asp-action="CaseClosed" asp-route-id="@Model.RequestId">
                <input type="hidden" name="RequestID" value="@Model.RequestId" class="input" />
                <input type="submit" value="Close Case" class="btn btn-info text-white rounded me-2">
            </form>
        </div>
    </div>

</div>

<script>
    function model_Case(id) {
        console.log(id);
        var modeldata = @Html.Raw(Json.Serialize(Model))
        document.getElementById('RequestID_Input_ModalAssignCase').value = id;
    }

    window.onload = function (e) {
        toggleFormElements('true')
    }
    function toggleFormElements(bDisabled) {
        var inputs = document.getElementsByClassName("input");
        var submit = document.getElementById("save");
        var editprofile = document.getElementById("edit");
        for (var i = 0; i < inputs.length; i++) {
            inputs[i].disabled = !inputs[i].disabled;
        }
        if (inputs[0].disabled) {
            submit.style.display = "none";
            editprofile.style.display = "block";
        } else {
            submit.style.display = "block";
            editprofile.style.display = "none";
        }
        document.getElementById("FirstName").disabled = (1 == 1);
        document.getElementById("LastName").disabled = (1 == 1);
        document.getElementById("DateOfBirth").disabled = (1 == 1);
    }
</script>